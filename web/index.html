<html>

<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
	<script src="pie.js"></script>
	<script src="boxscore.js"></script>

	<style>
		.team {
			display:inline-block;
			width:600px;
		}	
		table {
			border:solid;
			display:block;
			margin:auto;
		}
		tr {
		}
		.scoring-title {
			width:100px;
			margin:auto;
		}
		svg {
			display:block;
			margin:auto;
		}
	</style>

	<script>
		var homeTeam = {};
		var awayTeam = {};
		$.ajax({
		    type : 'POST',
		    url : 'http://eaganr.com:3000',           
		    data: {
					gameID : "0041400406"
				},
		    success:function (data) {
					console.log(data);
				
					homeTeam.id=data.gameSummary[0].homeTeamId;
					homeTeam.abbrev=data.teamStats[1].teamAbbreviation;
					awayTeam.id=data.gameSummary[0].visitorTeamId;
					awayTeam.abbrev=data.teamStats[0].teamAbbreviation;

					var homePlayers = [];
					var awayPlayers = [];
					for(var i=0;i<data.playerStats.length;i++) {
						var player = data.playerStats[i];
						if(player.teamId === homeTeam.id) {
							homePlayers.push(player);
						}
						if(player.teamId === awayTeam.id) {
							awayPlayers.push(player);
						}
					}
					console.log(homePlayers);
					console.log(awayPlayers);

					homeTeam.scoring = new pie("#homescoring")
						.value("pTS")
						.data(homePlayers)
						.diff("playerName")
						.label(function(d) { return d.data["playerName"]+" - "+d.data["pTS"];})
						.draw();	

					awayTeam.scoring = new pie("#awayscoring")
						.value("pTS")
						.data(awayPlayers)
						.diff("playerName")
						.label(function(d) { return d.data["playerName"]+" - "+d.data["pTS"];})
						.draw();

					//boxscore
					homeTeam.box = new boxscore("homebox",homePlayers);
					awayTeam.box = new boxscore("awaybox",awayPlayers);

					var homeRebs = [
						{abbrev:data.teamStats[1].teamAbbreviation, reb:data.teamStats[1].dREB},
						{abbrev:data.teamStats[0].teamAbbreviation, reb:data.teamStats[0].oREB}
					];
					var awayRebs = [
						{abbrev:data.teamStats[0].teamAbbreviation, reb:data.teamStats[0].dREB},
						{abbrev:data.teamStats[1].teamAbbreviation, reb:data.teamStats[1].oREB}
					];

					homeTeam.rebounds = new pie("#homerebounding")
						.value("reb")
						.data(homeRebs)
						.diff("abbrev")
						.label(function(d) { return d.data.abbrev+"-"+d.data.reb;})
						.draw();

					awayTeam.rebounds = new pie("#awayrebounding")
						.value("reb")
						.data(awayRebs)
						.diff("abbrev")
						.label(function(d) { return d.data.abbrev+"-"+d.data.reb;})
						.draw();

				}
		  });

	</script>


</head>

<body>
	
	<div class="team">
		<div class="scoring" id="homescoring"></div>
		<div class="rebounding" id="homerebounding"></div>
		<div class="boxscore" id="homebox"></div>
	</div>
	<div class="team">
		<div class="scoring" id="awayscoring"></div>
		<div class="rebounding" id="awayrebounding"></div>
		<div class="boxscore" id="awaybox"></div>
	</div>

</body>

</html
